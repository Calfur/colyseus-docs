import { Steps, Tabs, Callout } from "nextra/components"

# Authentication

In Colyseus, you can authenticate your users using the `onAuth` method in your room. This method is called before `onJoin`, and it is responsible for validating the client's request to join a room.

<Steps>

## The `onAuth` method

<Tabs items={["Static onAuth (recommended)", "Instance onAuth"]}>
    <Tabs.Tab>
    The `static onAuth` is recommended because it does not require the room instance to be created before authenticating the client.

    If you need to access the room instance during the authentication process, you can use the instance `onAuth` method instance.

    ```ts {5} filename="MyRoom.ts"
    import { Room } from "colyseus";
    import { JWT } from "@colyseus/auth";

    class MyRoom extends Room {
        static async onAuth (token, request) {
            // validate the token
            const userdata = await JWT.verify(token);

            // return userdata
            return userdata;
        }
    }
    ```
    </Tabs.Tab>

    <Tabs.Tab>
    The instance `onAuth` method is called after the room instance is created. This method is useful when you need to access the room instance properties, such as currently connected clients, or the room state.

    If you don't need to access the room instance properties, it's recommended to use the static `onAuth` method instead.

    ```ts {5} filename="MyRoom.ts"
    import { Room } from "colyseus";
    import { JWT } from "@colyseus/auth";

    class MyRoom extends Room {
        async onAuth (client, options, request) {
            // validate the token
            const authorization = request.headers.authorization;
            const userdata = await JWT.verify(authorization.substring(7, authorization.length));

            // return userdata
            return userdata;
        }
    }
    ```
    </Tabs.Tab>
</Tabs>

## Getting user data during `onJoin` method

```ts {5} filename="MyRoom.ts"
import { Room } from "colyseus";
// ...
class MyRoom extends Room {
    // ...
    async onJoin (client, options) {
        client.auth // contains the userdata
    }
}
```

## Client-side: Setting the auth token

The `client.auth.token` property is used to set the authentication token. This token will be sent as an `Authorization` header in all HTTP requests to the server.

```js filename="client.js"
// set the auth token
client.auth.token = "YOUR AUTH TOKEN";
```

<Callout type="info">
    If you are using the `@colyseus/auth` module, the `client.auth.token` property will be automatically set when the user is authenticated.
</Callout>


</Steps>